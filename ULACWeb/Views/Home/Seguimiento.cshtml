
@{
    ViewBag.Title = "Seguimiento";
    int IDEmpresa = Convert.ToInt32(Session["IDEmpresa"]);

}


<head>

    <style>
        .page-title {
            text-align: center;
            margin-top: 20px;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #912121;
        }
    </style>
</head>

<body>
@section navbarUsuario{
}

    <!-- Formulario de búsqueda y filtro -->
    <div class="search-form">
        <form id="search-form">
            <div class="ui-field-contain">
                <label for="filter-status">Estado:</label>
                <select id="filter-status" data-native-menu="false">
                    <option value="">Todos los estados</option>
                    <option value="En camino">En camino</option>
                    <option value="Entregado">Entregado</option>
                    <option value="Problemas">Problemas</option>
                </select>
            </div>
            <button type="button" onclick="filter()" class="ui-btn ui-btn-b">Filtrar</button>
        </form>
    </div>
    <form action="@Url.Action("ObtenerDatosSeguimiento", "Seguimiento")" method="post" data-ajax="false">
        <div class="ui-content">
            <button type="submit" class="ui-btn ui-btn-a">Cargar Datos</button>
        </div>
        <div class="ui-content">
            <table data-role="table" id="table-seguimiento" data-mode="reflow" class="ui-responsive table-stroke">
                <thead>
                    <tr>
                        <th>ID viaje</th>
                        <th>ID Empresa</th>
                        <th>Chofer</th>
                        <th>Estado</th>
                        <th>Compañía Contratante</th>
                        <th>Destino</th>
                        <th>Origen</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Count > 0)
                    {
                        foreach (var seguimiento in Model)
                        {
                            <tr>
                                <td>@seguimiento.IDViaje</td>
                                <td>@seguimiento.IDEmpresa</td>
                                <td>@seguimiento.Chofer</td>
                                <td>@seguimiento.Estado</td>
                                <td>@seguimiento.CompaniaContratante</td>
                                <td>@seguimiento.Destino</td>
                                <td>@seguimiento.Origen</td>
                            </tr>
                        }
                    }
                    
                </tbody>
            </table>
            <input type="hidden" name="IDEmpresa" value="@Session["IDEmpresa"]" />
        </div>
    </form>

   @section footer{
      }
    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JavaScript para filtrar y buscar viajes -->
    <script>
        $(document).ready(function () {
            $('#table-seguimiento').DataTable({
                "paging": true,
                "searching": true,
                "ordering": true,
                "info": true,
                "lengthMenu": [10, 25, 50, 100],
                "language": {
                    "lengthMenu": "Mostrar _MENU_ registros por página",
                    "zeroRecords": "No se encontraron resultados",
                    "info": "Mostrando _START_ a _END_ de _TOTAL_ registros",
                    "infoEmpty": "Mostrando 0 a 0 de 0 registros",
                    "infoFiltered": "(filtrado de _MAX_ registros totales)",
                    "paginate": {
                        "first": "Primero",
                        "previous": "Anterior",
                        "next": "Siguiente",
                        "last": "Último"
                    }
                },
                "dom": "<'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>>" +
                    "<'row'<'col-sm-12'tr>>" +
                    "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
                "classes": {
                    "table": "table table-striped table-bordered table-hover"
                }
            });
        });

    </script>
    <script>
        $(document).ready(function () {
            $("#search").on("keyup", function () {
                var value = $(this).val().toLowerCase();
                $("#movie-table tbody tr").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });
    </script>
    <script>
        $(document).on("pagecreate", function () {
            $.ajax({
                url: '/Seguimiento/ObtenerDatos', // Ruta del controlador para obtener los datos
                method: 'GET', // Método HTTP GET para obtener los datos
                success: function (data) {
                    // Actualiza el contenedor con los datos recibidos
                    $('#data-container').html(data).enhanceWithin(); // Asegura que los estilos de jQuery Mobile se apliquen correctamente
                },
                error: function (xhr, status, error) {
                    // Manejo de errores
                    console.error(error);
                }
            });
        });
    </script>

    <script>
        $(document).ready(function () {
            $('#table-seguimiento').DataTable({
                "columns": [
                    { "data": "ID_Viaje" },
                    { "data": "ID_Empresa" },
                    { "data": "Chofer" },
                    { "data": "Estado" },
                    { "data": "Compania_Contratante" },
                    { "data": "Destino" },
                    { "data": "Origen" }
                ]
            });
        });
    </script>

    <script>
        $(document).ready(function () {
            $('#table-seguimiento').DataTable({
                "language": {
                    "lengthMenu": "Mostrar _MENU_ registros por página",
                    "zeroRecords": "No se encontraron resultados",
                    "info": "Mostrando _START_ a _END_ de _TOTAL_ registros",
                    "infoEmpty": "Mostrando 0 a 0 de 0 registros",
                    "infoFiltered": "(filtrado de _MAX_ registros totales)",
                    "paginate": {
                        "first": "Primero",
                        "previous": "Anterior",
                        "next": "Siguiente",
                        "last": "Último"
                    }
                },
                "responsive": true,
                "columnDefs": [
                    {
                        "targets": [0, 1],
                        "visible": false
                    }
                ]
            });
        });

    </script>
    <!-- JavaScript para filtrar y buscar viajes -->
    <script>
       
            function filter() {
            // Obtener el valor seleccionado del filtro de estado
            var selectedStatus = $("#filter-status").val().toLowerCase();

            // Filtrar las filas de la tabla según el estado seleccionado
            $("#table-seguimiento tbody tr").each(function () {
                var rowStatus = $(this).find("td:eq(3)").text().toLowerCase(); // Obtener el estado de la fila

            // Mostrar u ocultar la fila según el estado seleccionado
            if (selectedStatus === "" || rowStatus.includes(selectedStatus)) {
                $(this).show();
                } else {
                $(this).hide();
                }
            });
        }
    </script>

</body>


